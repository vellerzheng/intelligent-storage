
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>


    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <meta http-equiv="x-ua-compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cloud Secure Storage</title>
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.css" rel="stylesheet">


    <title>文件下载链接</title>

    <title>文件下载链接地址</title>

</head>
<body>
<!-- 顶栏 -->
<div th:insert="~{fragments/header :: header}"></div>
<div class="container col-md-8 col-sm-offset-2 text-center">

    <table class="table table-bordered table-striped">
        <div id="tf-contact">
            <div class="container">

                <h2>文件上传</h2>
                <hr/>

                <div class="space"></div>
                <div class="row">
                    <div id="uploadFile" class="col-md-6 col-md-offset-3">
                        <form id="uploadForm" onsubmit="return check_submit();" enctype="multipart/form-data"  >
                            <div class="form-group">
                                <label  for="exampleInputFile">选择文件:</label>
                                <input type="file"  multiple="multiple" class="form-control " id="exampleInputFile"  name="file" placeholder="select local file" onmouseover="mover();" onclick="mclick();" onchange="fileChange(this);">
                            </div>
                            <div class="form-group">
                                <label for="exampleInputInfo">描述信息:</label>
                                <textarea  class="form-control" rows="4" id="exampleInputInfo"  name="description" placeholder="Detials & Information" onmouseover="mover();" onblur="mblur();" ></textarea>
                            </div>

                            <div>
                                <!-- 如果用户列表非空 -->
                                <a th:if ="${username !='' }">
                                    <input type ="hidden"  class="form-control"  id="username" name="username" th:value="${username}" />
                                </a>
                            </div>

                            <div class="form-group">
                                <button type="submit"  onclick="doUpload();" class="btn btn-primary my-btn dark">上传</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

    </table>
</div>

</body>

<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script th:src="@{/js/vue.js}"></script>
<script th:src="@{/js/vue-resource.js}"></script>
<script src="https://cdn.bootcss.com/parsley.js/2.8.1/parsley.js"></script>
<script type='text/javascript'>
    function doUpload(){
        var formData = new FormData($("#uploadForm")[0]);
        $.ajax({
            url : "/filemanager/uploadfile/add/",
            type: 'POST',
            data: formData,
            async: false,
            cache: false,
            contentType: false,
            processData: false,
            success : function(result) {
                if(result.resultCode == "2000"){
                    alert(result.resultMsg+" 点击确定，5秒后跳转页面！");
                    // 5秒后跳转，单位毫秒
                    setTimeout(redirectUrl("/filemanager/files"),5000);
                }
            },
            error : function(data) {
                alert("失败了！");
                setTimeout(redirectUrl("/filemanager/upladfile"),5000);
            }
        });
    }
</script>
</html>
